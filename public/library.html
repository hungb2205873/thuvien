<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Th∆∞ Vi·ªán S√°ch - BookHub</title>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/css/bootstrap.min.css" rel="stylesheet" />
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <!-- Header & Navigation -->
  <header class="header">
    <nav class="navbar">
      <div class="container">
        <div class="nav-wrapper">
          <div class="logo">
            <a href="index.html">üìö BookHub</a>
          </div>
          <button class="menu-toggle" id="menuToggle">
            <span></span>
            <span></span>
            <span></span>
          </button>
          <ul class="nav-menu" id="navMenu">
            <li><a href="index.html">Trang Ch·ªß</a></li>
            <li><a href="library.html" class="nav-active">Th∆∞ Vi·ªán</a></li>
            <li class="nav-dropdown">
              <a href="#" class="dropdown-toggle">Th·ªÉ Lo·∫°i</a>
              <ul class="dropdown-menu">
                <li><a href="#" onclick="filterBooks('all')">T·∫•t C·∫£</a></li>
                <li><a href="#" onclick="filterBooks('Ti·ªÉu Thuy·∫øt')">Ti·ªÉu Thuy·∫øt</a></li>
                <li><a href="#" onclick="filterBooks('Khoa H·ªçc')">Khoa H·ªçc</a></li>
                <li><a href="#" onclick="filterBooks('L·ªãch S·ª≠')">L·ªãch S·ª≠</a></li>
                <li><a href="#" onclick="filterBooks('T√¢m L√Ω')">T√¢m L√Ω</a></li>
                <li><a href="#" onclick="filterBooks('Kinh Doanh')">Kinh Doanh</a></li>
              </ul>
            </li>
            <li><a href="login.html" class="btn-auth">ƒêƒÉng Nh·∫≠p</a></li>
          </ul>
        </div>
      </div>
    </nav>
  </header>

  <!-- Library Page -->
  <section class="library-page">
    <div class="container">
      <!-- Page Header -->
      <div class="library-page-header">
        <h1>Th∆∞ Vi·ªán S√°ch Online</h1>
        <p>Kh√°m ph√° v√† t√¨m ki·∫øm h√†ng ng√†n cu·ªën s√°ch trong b·ªô s∆∞u t·∫≠p c·ªßa ch√∫ng t√¥i</p>
      </div>

      <!-- Search & Filter Section -->
      <div class="library-search-section">
        <div class="search-box">
          <input
            type="text"
            id="searchInput"
            class="search-input"
            placeholder="T√¨m ki·∫øm theo t√™n s√°ch, t√°c gi·∫£..."
          />
          <button class="search-btn" onclick="handleSearch()">üîç T√¨m Ki·∫øm</button>
        </div>
        
        <div class="filter-section">
          <button class="filter-btn active" onclick="filterBooks('all')">T·∫•t C·∫£</button>
          <button class="filter-btn" onclick="filterBooks('Ti·ªÉu Thuy·∫øt')">Ti·ªÉu Thuy·∫øt</button>
          <button class="filter-btn" onclick="filterBooks('Khoa H·ªçc')">Khoa H·ªçc</button>
          <button class="filter-btn" onclick="filterBooks('L·ªãch S·ª≠')">L·ªãch S·ª≠</button>
          <button class="filter-btn" onclick="filterBooks('T√¢m L√Ω')">T√¢m L√Ω</button>
          <button class="filter-btn" onclick="filterBooks('Kinh Doanh')">Kinh Doanh</button>
        </div>
      </div>

      <!-- Books Display -->
      <div class="row g-4" id="libraryBooksContainer">
        <!-- Books will be loaded here -->
      </div>

      <!-- No Results Message -->
      <div class="no-results" id="noResults" style="display: none;">
        <p>Kh√¥ng t√¨m th·∫•y s√°ch ph√π h·ª£p v·ªõi t√¨m ki·∫øm c·ªßa b·∫°n.</p>
      </div>
    </div>
  </section>

  <!-- Footer -->
  <footer class="footer">
    <div class="container">
      <div class="footer-content">
        <div class="footer-section">
          <h4>V·ªÅ BookHub</h4>
          <ul>
            <li><a href="#">Gi·ªõi Thi·ªáu</a></li>
            <li><a href="#">Li√™n H·ªá</a></li>
            <li><a href="#">Blog</a></li>
          </ul>
        </div>
        <div class="footer-section">
          <h4>Duy·ªát S√°ch</h4>
          <ul>
            <li><a href="#">S√°ch M·ªõi</a></li>
            <li><a href="#">S√°ch N·ªïi B·∫≠t</a></li>
            <li><a href="#">T√°c Gi·∫£</a></li>
          </ul>
        </div>
        <div class="footer-section">
          <h4>H·ªó Tr·ª£</h4>
          <ul>
            <li><a href="#">Trung T√¢m Tr·ª£ Gi√∫p</a></li>
            <li><a href="#">ƒêi·ªÅu Kho·∫£n S·ª≠ D·ª•ng</a></li>
            <li><a href="#">Ch√≠nh S√°ch Ri√™ng T∆∞</a></li>
          </ul>
        </div>
      </div>
      <div class="footer-bottom">
        <p>&copy; 2025 BookHub. T·∫•t c·∫£ quy·ªÅn ƒë∆∞·ª£c b·∫£o l∆∞u.</p>
      </div>
    </div>
  </footer>

  <script src="script.js"></script>
  <script>
    let currentFilter = 'all';
    let allBooks = [];

    async function loadBooks() {
      try {
        const response = await fetch('api/books.php'); // ƒê∆∞·ªùng d·∫´n API backend k·∫øt n·ªëi MySQL
        const data = await response.json();
        allBooks = data.map(book => ({
          ma_sach: book.ma_sach,
          ten_sach: book.ten_sach,
          ten_tac_gia: book.ten_tac_gia,
          nha_xuat_ban: book.nha_xuat_ban,
          nam_xuat_ban: book.nam_xuat_ban,
          so_luong: book.so_luong,
          ngay_them: book.ngay_them,
          ten_the_loai: book.ten_the_loai
        }));
        renderLibraryBooks();
      } catch (error) {
        console.error('L·ªói khi t·∫£i s√°ch:', error);
        // Fallback to mock data if API fails
        loadMockBooks();
      }
    }

    // Fallback mock data if MySQL API unavailable
    function loadMockBooks() {
      allBooks = [
        {
          ma_sach: 1,
          ten_sach: "ƒê·∫Øc Nh√¢n T√¢m",
          ten_tac_gia: "Dale Carnegie",
          nha_xuat_ban: "Nh√† Xu·∫•t B·∫£n A",
          nam_xuat_ban: 2020,
          so_luong: 5,
          ngay_them: "2024-01-15",
          ten_the_loai: "T√¢m L√Ω",
        },
        {
          ma_sach: 2,
          ten_sach: "T∆∞ Duy Nhanh v√† Ch·∫≠m",
          ten_tac_gia: "Daniel Kahneman",
          nha_xuat_ban: "Nh√† Xu·∫•t B·∫£n B",
          nam_xuat_ban: 2019,
          so_luong: 3,
          ngay_them: "2024-01-20",
          ten_the_loai: "T√¢m L√Ω",
        },
        {
          ma_sach: 3,
          ten_sach: "D·∫°y Con L√†m Gi√†u",
          ten_tac_gia: "Robert T. Kiyosaki",
          nha_xuat_ban: "Nh√† Xu·∫•t B·∫£n C",
          nam_xuat_ban: 2021,
          so_luong: 8,
          ngay_them: "2024-01-25",
          ten_the_loai: "Kinh Doanh",
        },
      ];
      renderLibraryBooks();
    }

    // Render library books with MySQL data fields
    function renderLibraryBooks(books = allBooks) {
      const container = document.getElementById('libraryBooksContainer');
      const noResults = document.getElementById('noResults');

      if (books.length === 0) {
        container.innerHTML = '';
        noResults.style.display = 'block';
      } else {
        noResults.style.display = 'none';
        container.innerHTML = books
          .map(
            (book) => `
          <div class="col-lg-3 col-md-4 col-sm-6 col-12">
            <div class="book-card">
              <div class="book-cover">üìö</div>
              <div class="book-info">
                <div class="book-title">${book.ten_sach}</div>
                <div class="book-author">T√°c gi·∫£: ${book.ten_tac_gia}</div>
                <div class="book-meta">
                  <p><strong>NXB:</strong> ${book.nha_xuat_ban}</p>
                  <p><strong>NƒÉm:</strong> ${book.nam_xuat_ban}</p>
                  <p><strong>S·ªë l∆∞·ª£ng:</strong> ${book.so_luong}</p>
                  <p><strong>Th·ªÉ lo·∫°i:</strong> ${book.ten_the_loai}</p>
                  <p><strong>Ng√†y th√™m:</strong> ${book.ngay_them}</p>
                </div>
                <a href="login.html" class="btn btn-primary" style="display: block; text-align: center;">M∆∞·ª£n S√°ch</a>
              </div>
            </div>
          </div>
        `,
          )
          .join('');
      }
    }

    // Filter books by category
    function filterBooks(category) {
      currentFilter = category;
      
      document.querySelectorAll('.filter-btn').forEach(btn => {
        btn.classList.remove('active');
        if (btn.textContent.includes(category === 'all' ? 'T·∫•t C·∫£' : category)) {
          btn.classList.add('active');
        }
      });

      if (category === 'all') {
        renderLibraryBooks(allBooks);
      } else {
        const filtered = allBooks.filter(book => book.ten_the_loai === category);
        renderLibraryBooks(filtered);
      }
    }

    // Search books
    function handleSearch() {
      const searchInput = document.getElementById('searchInput').value.toLowerCase();
      
      if (searchInput.trim() === '') {
        filterBooks(currentFilter);
        return;
      }

      const results = allBooks.filter(book =>
        book.ten_sach.toLowerCase().includes(searchInput) ||
        book.ten_tac_gia.toLowerCase().includes(searchInput) ||
        book.nha_xuat_ban.toLowerCase().includes(searchInput)
      );

      renderLibraryBooks(results);
    }

    // Allow search on Enter key
    document.getElementById('searchInput').addEventListener('keypress', (e) => {
      if (e.key === 'Enter') {
        handleSearch();
      }
    });

    // Initialize library page
    document.addEventListener('DOMContentLoaded', () => {
      loadBooks();
    });
  </script>
</body>
</html>
